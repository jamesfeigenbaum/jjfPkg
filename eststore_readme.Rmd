---
title: "Eststore Readme"
author:
  - James Feigenbaum
date: "October 8, 2017"
---

Storing regressions in stata was way easier than in R. However, this version of the eststore command from stata help a lot.

I will eventually put this together as a package on its own, but for now I'll put it in my personal package.

``` {r message = FALSE, warning = FALSE}
library(tidyverse)
library(stargazer)
```

The old way of doing this:

```{r oldway}
est1 <-
  mtcars %>%
  lm(data = ., mpg ~ disp)

est2 <-
  mtcars %>%
  lm(data = ., mpg ~ hp)

est3 <-
  mtcars %>%
  lm(data = ., mpg ~ disp + hp)

stargazer(est1, est2, est3, type = "text")
```

Sort of annoying to type in the `estX` and assign them and to have to increment them, right?

In my new way of doing this, I have a function `eststore`. You give it (or pipe it) regression output and the name of an `estlist` to store into. That `estlist` can exist or not. If it doesn't already exist, `eststore` will create it. If no `estlist` name is given, `estlist` will be used as the default.

```{r newway}
eststore <- function(est, estlist_arg = estlist) {

  # estlist name
  estlist_string <-
    substitute(estlist_arg) %>%
    deparse()

  # if the estlist doesn't already exist or is empty make it
  # otherwise add to it
  if (!exists(estlist_string)) {
    
    out <-
      est %>%
      list()
    
  } else {
    
    out <-
      est %>%
      list() %>%
      c(estlist_arg, .)
    
  }
  
  enviro <-
    environment() %>%
    parent.env()

  estlist_string %>% 
    assign(out, pos = enviro)
  
}
```

Try it with an estlist name given:

```{r}
# with an estlist name given
mtcars %>%
  lm(data = ., mpg ~ disp) %>%
  eststore(car_regs)

mtcars %>%
  lm(data = ., mpg ~ hp) %>%
  eststore(car_regs)

mtcars %>%
  lm(data = ., mpg ~ disp + hp) %>%
  eststore(car_regs)

```

Or without a name given:

```{r}
# without an estlist name given
mtcars %>%
  lm(data = ., mpg ~ disp) %>%
  eststore()

mtcars %>%
  lm(data = ., mpg ~ hp) %>%
  eststore()

mtcars %>%
  lm(data = ., mpg ~ disp + hp) %>%
  eststore()

```

Output looks great in `stargazer` either way:

```{r}
stargazer(car_regs, type = "text")

# even if you don't name the estlist, stargazer still needs it
stargazer(estlist, type = "text")
```